<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ item.title_jp }}</title>
    <style>
        body { font-family: 'Noto Serif JP', serif; line-height: 1.8; max-width: 800px; margin: 0 auto; padding: 40px 20px; background: #fff; color: #222; }
        h1 { color: #002244; font-size: 2.2rem; border-bottom: 4px solid #e63946; padding-bottom: 15px; margin-top: 0; }
        .lang-switch { text-align: right; margin-bottom: 20px; }
        .lang-switch button { padding: 8px 15px; cursor: pointer; background: #002244; color: white; border: none; border-radius: 4px; }
        .article-section { margin: 40px 0; font-size: 1.15rem; }
        .critique-box { background: #fff5f5; padding: 30px; border-radius: 10px; margin: 50px 0; border-left: 10px solid #e63946; }
        .hints-container { display: flex; gap: 20px; margin: 40px 0; }
        .hint-card { flex: 1; background: #f0fdf4; padding: 20px; border: 1px solid #bbf7d0; border-radius: 8px; }
        .proverb-footer { background: #002244; color: white; padding: 30px; border-radius: 12px; margin-top: 60px; }
        .term-hl { border-bottom: 2px dotted #e63946; cursor: pointer; background: #ffffcc; padding: 0 2px; }
        #popup { position: fixed; bottom: -150px; left: 0; width: 100%; background: #002244; color: white; padding: 25px; transition: 0.4s; z-index: 1000; text-align: center; box-sizing: border-box; }
        #popup.active { bottom: 0; }
        .en, .jp { display: none; }
        .back-nav { margin-bottom: 30px; }
        .back-nav a { text-decoration: none; color: #002244; font-weight: bold; }
    </style>
</head>
<body>
    <div class="back-nav"><a href="../index.html">‚Üê TOP PAGE</a></div>
    <div class="lang-switch"><button onclick="toggleLang()">JP / EN</button></div>

    <article>
        <h1 class="jp">{{ item.title_jp }}</h1><h1 class="en">{{ item.title_en }}</h1>
        <p style="color: #666;">{{ item.date }}</p>

        <div class="article-section">
            <div class="jp" id="main-jp">{{ item.content_jp | replace('\n', '<br>') }}</div>
            <div class="en" id="main-en">{{ item.content_en | replace('\n', '<br>') }}</div>
        </div>

        <div class="critique-box">
            <h3 class="jp">Crimson Pen„ÅÆÈã≠„ÅÑË¶ñÁÇπ</h3><h3 class="en">The Crimson Pen's Sharp View</h3>
            <div class="jp">{{ item.critique_jp }}</div><div class="en">{{ item.critique_en }}</div>
        </div>

        <div class="hints-container">
            <div class="hint-card">
                <strong>üìà <span class="jp">ÊäïË≥á„ÅÆ„Éí„É≥„Éà</span><span class="en">Investment Hint</span></strong>
                <p class="jp">{{ item.investment_hint_jp }}</p><p class="en">{{ item.investment_hint_en }}</p>
            </div>
            <div class="hint-card">
                <strong>üí° <span class="jp">‰∫∫Áîü„ÅÆ„Éí„É≥„Éà</span><span class="en">Life Hint</span></strong>
                <p class="jp">{{ item.life_hint_jp }}</p><p class="en">{{ item.life_hint_en }}</p>
            </div>
        </div>

        <div class="proverb-footer">
            <h3>üìñ <span class="jp">‰ªäÊó•„ÅÆ„Åì„Å®„Çè„Åñ</span><span class="en">Today's Proverb</span></h3>
            <p style="font-size: 1.4rem;"><strong><span class="jp">{{ item.proverb.title_jp }}</span><span class="en">{{ item.proverb.title_en }}</span></strong></p>
            <p class="jp">{{ item.proverb.desc_jp }}</p><p class="en">{{ item.proverb.desc_en }}</p>
        </div>
    </article>

    <div id="popup"><strong id="p-term"></strong>: <span id="p-def"></span></div>

    <script>
        const glossary = {{ item.glossary | tojson }};
        let lang = localStorage.getItem('lang') || 'jp';
        function toggleLang() { lang = lang === 'jp' ? 'en' : 'jp'; localStorage.setItem('lang', lang); location.reload(); }

        function showDef(t, d) {
            document.getElementById('p-term').innerText = t;
            document.getElementById('p-def').innerText = d;
            document.getElementById('popup').classList.add('active');
            setTimeout(() => document.getElementById('popup').classList.remove('active'), 8000);
        }

        // Áî®Ë™û„Éè„Ç§„É©„Ç§„ÉàÂá¶ÁêÜ
        ['jp', 'en'].forEach(l => {
            const container = document.getElementById('main-' + l);
            let html = container.innerHTML;
            glossary.forEach(g => {
                const term = l === 'jp' ? g.term_jp : g.term_en;
                const def = l === 'jp' ? g.def_jp : g.def_en;
                html = html.replace(new RegExp(term, 'g'), `<span class="term-hl" onclick="showDef('${term}','${def}')">${term}</span>`);
            });
            container.innerHTML = html;
        });

        document.querySelectorAll('.' + lang).forEach(e => e.style.display = 'block');
    </script>
</body>
</html>
